<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What is `SpaDES`? • SpaDES.Workshops</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="What is `SpaDES`?">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58633549-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58633549-3');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
  <span class="sr-only">Toggle navigation</span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    </button>
    <span class="navbar-brand">
    <a class="navbar-link" href="../index.html">SpaDES.Workshops</a>
    <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
    </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
    <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">2021-Jan</a>
</li>
  <li>
  <a href="../articlesJan2020/index.html">2020-Jan</a>
  </li>
  <li>
  <a href="../articlesOct2019/index.html">2019-Fall</a>
  </li>
  <li>
  <a href="../articlesSept2018/index.html">2018-Fall</a>
  </li>
  <li>
  <a href="../articlesMay2018/index.html">2018-May</a>
  </li>
  <li>
  <a href="../articlesFeb2018/index.html">2018-Feb</a>
  </li>
  <li>
  <a href="http://rpubs.com/PredictiveEcology/SpaDES-Intro-Course-Outline">Prior to 2018</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://spades.predictiveecology.org/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>What is <code>SpaDES</code>?</h1>
                        <h4 class="author">Ceres Barros, Eliot McIntire, Tati Micheletti, Alex Chubaty</h4>
            
            <h4 class="date">October 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PredictiveEcology/SpaDES.Workshops/blob/master/vignettes/01a-WhatIsSpades.Rmd"><code>vignettes/01a-WhatIsSpades.Rmd</code></a></small>
      <div class="hidden name"><code>01a-WhatIsSpades.Rmd</code></div>

    </div>

    
    
<div id="what-is-spades-and-how-does-it-work" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-spades-and-how-does-it-work" class="anchor"></a>What is <code>SpaDES</code> and how does it work?</h2>
<div id="why-is-modelling-important" class="section level3">
<h3 class="hasAnchor">
<a href="#why-is-modelling-important" class="anchor"></a>Why is modelling important?</h3>
<p>Models are nowadays so important and widespread that we often don’t realize that most of what we use in our daily lives is the result of someone’s (or some team’s) model. From weather forecasting, to predicting stock market fluctuations. From the design of your bike, to the estimation of blood sugar and insulin levels and how they vary hourly and according to different diets (in case you don’t know, this can be important for diabetes treatments, and drug dosage and scheduling)… Models are indeed ‘everywhere’.</p>
<p><img src="images/Day01/models_everywhere.png" align="middle" height="400" width="750" margin="0 auto"></p>
</div>
<div id="challenges-modellers-face" class="section level3">
<h3 class="hasAnchor">
<a href="#challenges-modellers-face" class="anchor"></a>Challenges modellers face</h3>
<p>In a world where disciplines often interact to study complex questions, like climate change, natural resource management, or even where to build an offshore wind farm, modellers (and model users!) face challenges that can impair scientific and social progress:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Many models, low integration</strong>
<ul>
<li>different scientific teams/individuals develop models to investigate the same question - which to choose?</li>
<li>these models sometimes vary in their degree of complexity - when is one more appropriate than the other?</li>
<li>and are often written in different programming languages, sometimes making their comparison, integration and development harder (especially for those who are not the model authors!)</li>
</ul>
</li>
<li>
<strong>High complexity</strong>
<ul>
<li>often solving a question, or problem, requires the cooperation of different teams, each contributing with distinct data and, possibly, models that need to be integrated;</li>
</ul>
</li>
</ol>
<p><img src="images/Day01/High_complexity.png" align="middle" width="300"></p>
<p><img src="images/Day01/Big_data_modelupdates.png" align="right" width="200"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Era of <em>big data</em> </strong>
<ul>
<li>data availability and volume are increasing <em>FAST</em>;</li>
<li>today’s model, will be outdated tomorrow -&gt; models need to be constantly updated, revised and re-validated and re-calibrated.</li>
</ul>
</li>
<li>
<strong>Reproducibility and transparency</strong>
<ul>
<li>one of the first premisses of scientific method is to repeat analyses and verify whether hypotheses hold in different conditions -&gt; science <em>must</em> be reproducible in order to progress;</li>
<li>models (and modellers!) should be open to change and adaptation;</li>
<li>results and conclusions <em>must</em> be shared with stakeholders, managers, policy makers and the general public.</li>
</ul>
</li>
</ol>
</div>
<div id="how-do-we-tackle-these-issues---continuous-adaptive-management" class="section level3">
<h3 class="hasAnchor">
<a href="#how-do-we-tackle-these-issues---continuous-adaptive-management" class="anchor"></a>How do we tackle these issues? -&gt; <em>continuous adaptive management</em>
</h3>
<p>Continuous adaptive management is an existing framework that assumes a periodic re-assessment of the status of a situation or issue, e.g. the amount of waste a company produces. This leads to the design and implementation of new solutions - e.g. recycling paper or using rain water - their monitoring and evaluation, and their adjustment if need be, before the next assessment.</p>
<p>In modelling terms, this framework implies that for a given problem/question analyses and forecasts are repeated as new data, new methodologies and new or improved models arise. This can lead to a re-assessment of risk, inform decisions and influence policy making. These can in turn feedback into the process of re-framing the initial problem/question.</p>
<p>Although this framework is ideal, it is only seldomly applied across the scientific community.</p>
<p>Why? Because we are yet far from developing our research in a way that is easily repeatable, “upgradeable” and shareable. This renders the application of the continuous adaptive management framework costly, both temporally and financially, especially in interdisciplinary projects that involve multiple teams and stakeholders.</p>
<p><img src="images/Day01/contadaptmanag_nightmare.png" align="middle" width="600"></p>
</div>
<div id="where-do-we-go-from-here-spades" class="section level3">
<h3 class="hasAnchor">
<a href="#where-do-we-go-from-here-spades" class="anchor"></a>Where do we go from here? <strong><code>SpaDES</code>!</strong>
</h3>
</div>
<div id="what-is-spades" class="section level3">
<h3 class="hasAnchor">
<a href="#what-is-spades" class="anchor"></a><strong>What is <code>SpaDES</code>?</strong>
</h3>
<p><code>SpaDES</code> - <em>Spa</em>tial <em>D</em>iscrete <em>E</em>vent <em>S</em>imulator - is a modelling framework in the form of an ensemble of <code>R</code> packages. It aims to provide modellers and non-modellers across different domains of life and earth sciences (and beyond!) with a modelling tool that they can <em>control</em>, <em>apply</em> and <em>develop</em>. In its whole, <code>SpaDES</code> bridges the gaps between modellers and model-users of different disciplines, between scientists, practitioners, managers, stakeholders and policy makers, and between scientists and the general public.</p>
<p><strong>How?</strong><br>
1. <code>SpaDES</code> is written in <code>R</code>: a widely understood programming language, highly suited to statistical analyses, but flexible and fast enough to accommodate simulation work;<br>
2. <code>SpaDES</code> can be used for a wide-range of modelling approaches: + process-based models; + phenomenological models; + spatially-explicit models; + … 3. <code>SpaDES</code> models are built of <em>modules</em>, i.e. self-contained, interacting pieces that execute a particular <em>event</em>, or process in the model; 4. <code>SpaDES</code> modules can be made available across the entire <code>R</code> community if module-developers wish it so; 5. <code>SpaDES</code> will soon include a web-app builder to make interactive simulation possible.</p>
<p>Like a smart-phone where users install and use the apps that they want, <code>SpaDES</code> can be seen as a platform where a model can be “assembled” from various pre-made modules. This allows non-modellers to run someone else’s model on <em>their</em> data and <em>their</em> parameters, and, on the other hand, it allows modellers write their own modules from scratch, run them and share them with the <code>R</code> user community.</p>
<div id="an-example" class="section level4">
<h4 class="hasAnchor">
<a href="#an-example" class="anchor"></a><strong>An example</strong>
</h4>
<p>Our question(s): how will forest fires affect forest age? And how will climate change affect fire regimes and in turn the vegetation? How will timber supply be affected?</p>
<p><img src="images/Day01/Smart_SpaDES.png" align="right" width="300"></p>
<p><strong>To start we’ll need:</strong></p>
<ul>
<li>a vegetation dynamics module - e.g. <a href="https://github.com/PredictiveEcology/SpaDES-modules/tree/master/modules/forestAge">forestAge</a>;</li>
<li>a fire simulator - e.g. <a href="https://github.com/PredictiveEcology/SpaDES-modules/tree/master/modules/forestSuccessionBeacons">forestSuccessionBeacons</a> modules;</li>
<li>optional:
<ul>
<li>the interaction between fire and vegetation</li>
<li>statistical analyses/presentation of results</li>
</ul>
</li>
</ul>
<p>Depending on how modules are built, the interaction between modules may or may not require additional modules. Similarly, the presentation of results and their analyses can be directly made within the module producing them, or <em>as posteriori</em> using another module. Your call. <code>SpaDES</code> is all about flexibility!</p>
<p>Using the above mentioned modules would already allow an analysis of how fires affect forest age, and vice-versa.</p>
<p><strong>Then add climate-change, timber supply models…</strong><br>
Analysing the effects of climate change could then be done by varying fire-related parameters (e.g. frequency and intensity of fires) in a simulation experiment. Alternatively, an additional module could simulate climate change effects, which would feedback unto both fire parameters and vegetation.<br>
Finally, a timber supply module could “read” the vegetation maps produced after fire simulations and calculate timber quantity and quality from forest conditions (e.g. surviving tree species and their age).</p>
<p><strong>Reserve, add new data, and re-run</strong><br>
Provided that modules are able to download, read and treat data adequately, updating the simulations for new data is easy. <code>SpaDES</code> comes with a set of functions (via the <code>reproducible</code> package) that enable caching model structure, parameters and simulation results. This way, if new data only affects a section of the model, the user won’t have to repeat every step to update the simulations.</p>
<ul>
<li>Learn more about: <a href="http://spades-workshops.predictiveecology.org/articles/03a-Existing-modules.html#how-to-share-modules">sharing modules</a> and caching (<a href="https://cran.r-project.org/web/packages/SpaDES/vignettes/iii-cache.html">here</a> and <a href="http://spades-workshops.predictiveecology.org/articles/Continuous-Workflow.html">here</a>)</li>
</ul>
<p><strong>Decorate and serve</strong><br>
Because models are not just for modellers, a shiny app building package is being developed to transform any <code>SpaDES</code> simulation into a web-app. This provides an interactive way of visualising results, as users can change simulation parameters and turn modules on and off, whilst observing how this impacts simulation results. Importantly, it can be particularly useful when conveying results to a non-expert or even the public.</p>
<p>Shiny web-app demo <a href="https://spades.shinyapps.io/ForestChange_ProofOfConcept/">here</a> and <a href="http://landweb.ca">here</a></p>
<hr>
<hr>
</div>
</div>
</div>
<div id="exercises--getting-started-with-spades-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#exercises--getting-started-with-spades-in-r" class="anchor"></a>Exercises. Getting started with <code>SpaDES</code> in <code>R</code>
</h2>
<div id="installing-spades" class="section level3">
<h3 class="hasAnchor">
<a href="#installing-spades" class="anchor"></a>1.1 Installing <code>SpaDES</code>
</h3>
<p><code>SpaDES</code> groups a series of <code>R</code> packages - <em>metapackage</em> - containing both core and additional methods to design a discrete event simulation model:</p>
<ol style="list-style-type: decimal">
<li>an <strong>up to date version of <code>R</code></strong> - having R Studio, or another <code>R</code> editor might also be useful.<br>
</li>
<li>the package <code>devtools</code> installed<br>
</li>
<li>
<a href="https://cran.r-project.org/bin/windows/Rtools/"><strong>Rtools</strong></a> (Windows), <a href="http://itunes.apple.com/us/app/xcode/id497799835?mt=12"><strong>XCode</strong></a> (Mac), or r-base (Linux; please see <a href="https://support.rstudio.com/hc/en-us/articles/200486498-Package-Development-Prerequisites">here</a> for details).</li>
</ol>
<p><code>SpaDES</code>is still on a relatively steep development curve. As such, it might be sometimes necessary to update a particular package from Git Hub (where <code>SpaDES</code> is being developed). It might be important to keep an eye on new improvements present in Git Hub that might not be in CRAN yet. You’ll find the latest releases for each package in their respective Git Hub page (e.g. <a href="https://github.com/PredictiveEcology/SpaDES.core/releases">SpaDES.core releases</a>). If you go to the <a href="https://github.com/PredictiveEcology/SpaDES.core/commits/development">commits page</a> you’ll notice that that there might be new features relatively to the latest commit.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">###################</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># Make sure your existing packages are updated, and correct for the version of R</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">###################</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Get latest versions of key SpaDES packages from CRAN</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>dependencies &lt;-<span class="st"> </span>tools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/tools/package_dependencies.html">package_dependencies</a></span>(<span class="st">"SpaDES"</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># Update any versions of these dependencies that are already on your machine</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw"><a href="https://rdrr.io/r/utils/update.packages.html">update.packages</a></span>(<span class="dt">oldPkgs =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(dependencies), <span class="dt">ask =</span> <span class="ot">FALSE</span>, <span class="dt">checkBuilt =</span> <span class="ot">TRUE</span>) </span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Install any dependencies that are missing -- </span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#   install.packages is not getting correct dependencies</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>missingPkgs &lt;-<span class="st"> </span>dependencies<span class="op">$</span>SpaDES[<span class="op">!</span>(dependencies<span class="op">$</span>SpaDES <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>()))]</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="cf">if</span> (<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(missingPkgs))</span>
<span id="cb1-14"><a href="#cb1-14"></a>  <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(missingPkgs, <span class="dt">dependencies =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">###################</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">## Install all SpaDES packages </span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">###################</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'SpaDES'</span>, <span class="dt">dependencies =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co">## now, update some of the packages from the development branch.</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"PredictiveEcology/reproducible"</span>, <span class="dt">ref =</span> <span class="st">"development"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"PredictiveEcology/quickPlot"</span>, <span class="dt">ref =</span> <span class="st">"development"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-25"><a href="#cb1-25"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"PredictiveEcology/SpaDES.tools"</span>, <span class="dt">ref =</span> <span class="st">"development"</span>, <span class="dt">dependencies =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-26"><a href="#cb1-26"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"PredictiveEcology/SpaDES.core"</span>, <span class="dt">ref =</span> <span class="st">"development"</span>, <span class="dt">dependencies =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="modules-included-in-the-spades-package" class="section level3">
<h3 class="hasAnchor">
<a href="#modules-included-in-the-spades-package" class="anchor"></a>1.2 Modules included in the <code>SpaDES</code> package</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">## load SpaDES</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">## RESTART R -- using Ctrl-Shift-F10 (may work if in Rstudio) or other</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(SpaDES)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">## Locate the sample modules in SpaDES.core</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>sampleModuleDir &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">'sampleModules'</span>, <span class="dt">package =</span> <span class="st">'SpaDES.core'</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>    </span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">## list the modules in this directory</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(sampleModuleDir)</span></code></pre></div>
<p><strong>What do these modules do?</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">## open the sample module Rmd file to learn more about the modules and access a simple example</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>sampleModuleFiles &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(sampleModuleDir, <span class="dt">pattern =</span> <span class="st">'Rmd$'</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">## open the Rmd file</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/file.edit.html">file.edit</a></span>(sampleModuleFiles)</span></code></pre></div>
<p>As a best practice, modules should come with an <em>.Rmd</em> file that provides a summary of how the module works and <em>reproducible</em> example, though this is not actually imposed. If you’ve ever searched for R-help on <strong>stackoverflow</strong> you’ll have noticed how people try to provide <code>R</code> code that can be run in any machine to reproduce the problem/solution at hand. Module <em>.Rmd</em> files should also run in any machine.</p>
</div>
<div id="simulation-modelling-with-spades" class="section level3">
<h3 class="hasAnchor">
<a href="#simulation-modelling-with-spades" class="anchor"></a>1.3 Simulation modelling with <code>SpaDES</code>
</h3>
<p>Let’s go back to the modelling question discussed briefly above.</p>
<p>Our first objective is to simulate the effect of fire on forest age. There are two main components to such a model, which need to interact:</p>
<ol style="list-style-type: decimal">
<li>a fire simulator;</li>
<li>a forest age simulator.</li>
</ol>
<div id="download-modules" class="section level4">
<h4 class="hasAnchor">
<a href="#download-modules" class="anchor"></a>1.3.1 Download modules</h4>
<p>The <code>LCC2005</code> module group provides a set of modules that can reproduce these dynamics (in a simple way).</p>
<p>Let’s define the working directories of our simulation exercise (<em>SpaDESintro</em>) first.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>main.dir &lt;-<span class="st">  "~/temp_SpaDESws"</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">## We'll create the necessary directories in a temporary location - feel free to change this if you wish to.</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">setPaths</span>(<span class="dt">cachePath =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(main.dir,<span class="st">'cache'</span>),</span>
<span id="cb4-5"><a href="#cb4-5"></a>         <span class="dt">inputPath =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(main.dir, <span class="st">'inputs'</span>),</span>
<span id="cb4-6"><a href="#cb4-6"></a>         <span class="dt">modulePath =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(main.dir, <span class="st">'modules'</span>),</span>
<span id="cb4-7"><a href="#cb4-7"></a>         <span class="dt">outputPath =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(main.dir, <span class="st">'outputs'</span>))</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">## verify that this is want you wanted:</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">getPaths</span>()</span></code></pre></div>
<p>Now we’ll get <code>LCC2005</code> modules needed and save them in the <code>modules</code> folder created before. If you already have done this before and want to do it again, set the <code>overwrite</code> argument to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">## note how we use the modules folder defined above and chose to download the necessary data</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">downloadModule</span>(<span class="st">'LCC2005'</span>, <span class="dt">path =</span> <span class="kw">getPaths</span>()<span class="op">$</span>modulePath, <span class="dt">repo =</span> <span class="st">'PredictiveEcology/SpaDES-modules'</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Now we can download the data needed for the modules.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">downloadData</span>(<span class="st">"LccToBeaconsReclassify"</span>) <span class="co"># 41 MB file</span></span></code></pre></div>
<p>But what happens if the module doesn’t require any data? Let’s try to download data for any other module that doesn’t need data.</p>
<p>In the next block, why does the second one re-download the same dataset as we just downloaded?</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">downloadData</span>(<span class="st">"fireSpreadLcc"</span>) <span class="co"># Note it will hit the error "Error in curl::curl_fetch_memory(url, handle = handle) : Could not resolve host: NA".</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">downloadData</span>(<span class="st">"cropReprojectLccAge"</span>) <span class="co"># Note that there is an error in the end of this download (at the last file). "Could not resolve host: ftp.daac.ornl.gov". This is related to a missing map that we will fix below</span></span></code></pre></div>
<p>Unfortunately, the forest age raster (<code>can_age04_1km.tif</code>) is no longer downloadable without creating an account on the NASA EarthData website. We have provided a copy, which you can download from <a href="https://drive.google.com/file/d/1bD957dewv3U-cbISfeUEz1QpGg5DurR-/view?usp=sharing">here</a> and put in <code><a href="https://rdrr.io/r/base/file.path.html">file.path(getPaths()$modulePath, "cropReprojectLccAge/data")</a></code> and <code><a href="https://rdrr.io/r/base/file.path.html">file.path(getPaths()$modulePath, "modules/forestAge/data")</a></code> (this will only be possible during the workshop). However, downloading objects/files from the internet is a common problem. To enhance reproducibility, the function will not download a file again if it has a local copy:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># downloads</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>age &lt;-<span class="st"> </span><span class="kw">prepInputs</span>(<span class="dt">url =</span> <span class="st">"https://drive.google.com/file/d/1bD957dewv3U-cbISfeUEz1QpGg5DurR-/view?usp=sharing"</span>,</span>
<span id="cb8-3"><a href="#cb8-3"></a>                  <span class="dt">destinationPath =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw">getPaths</span>()<span class="op">$</span>modulePath, <span class="st">"cropReprojectLccAge/data"</span>))</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co"># doesn't download, because it is already there -- uses Checksums</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>age &lt;-<span class="st"> </span><span class="kw">prepInputs</span>(<span class="dt">url =</span> <span class="st">"https://drive.google.com/file/d/1bD957dewv3U-cbISfeUEz1QpGg5DurR-/view?usp=sharing"</span>,</span>
<span id="cb8-7"><a href="#cb8-7"></a>                  <span class="dt">destinationPath =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw">getPaths</span>()<span class="op">$</span>modulePath, <span class="st">"cropReprojectLccAge/data"</span>))</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/filename.html">filename</a></span>(age),</span>
<span id="cb8-10"><a href="#cb8-10"></a>          <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="kw">getPaths</span>()<span class="op">$</span>modulePath, <span class="st">"forestAge/data"</span>))</span></code></pre></div>
<p>For future reference, it is possible to create an account on the NASA EarthData website and, after logging in, you’ll find the file <a href="https://daac.ornl.gov/NACP/guides/NA_Tree_Age.html">here</a>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">## open the description of the LCC2005 module group - on Windows this doesn't work because of an Rstudio issue, instead the message provides the lines to copy and paste</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">openModules</span>(<span class="st">'LCC2005'</span>, <span class="dt">path =</span> <span class="kw">getPaths</span>()<span class="op">$</span>modulePath) </span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">## list all module files within LCC2005 and open them</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>LCC2005ModuleFiles &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="kw">getPaths</span>()<span class="op">$</span>modulePath, <span class="dt">pattern =</span> <span class="st">'Rmd$'</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">## open module Rmd files</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw"><a href="https://rdrr.io/r/utils/file.edit.html">file.edit</a></span>(LCC2005ModuleFiles[<span class="dv">1</span>])</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(LCC2005ModuleFiles, file.edit)</span></code></pre></div>
<p>As you can see, <code>LCC2005</code> is a module group, meaning that it contains several modules that work together. Find more about module groups <a href="http://spades-workshops.predictiveecology.org/articles/03a-Existing-modules.html#parent-modules-a-k-a--module-groups">here</a>.</p>
<p>In this exercise, we will follow a simplified version of the example contained in the <code>LCC2005.Rmd</code> file. We will only use the modules necessary to simulate vegetation dynamics (<code>cropReprojectLccAge</code>, <code>forestAge</code>, <code>forestSuccessionBeacons</code> and <code>LccToBeaconsReclassify</code>) and fire spread (<code>fireSpreadLcc</code>).</p>
</div>
<div id="simulation-setup" class="section level4">
<h4 class="hasAnchor">
<a href="#simulation-setup" class="anchor"></a>1.3.2 Simulation setup</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">## We've defined the paths earlier </span></span>
<span id="cb10-2"><a href="#cb10-2"></a>paths &lt;-<span class="st"> </span><span class="kw">getPaths</span>()</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">## we'll use several, but not all the modules in LCC2005</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>modules &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"cropReprojectLccAge"</span>, <span class="st">"fireSpreadLcc"</span>, <span class="st">"forestAge"</span>, <span class="st">"forestSuccessionBeacons"</span>, <span class="st">"LccToBeaconsReclassify"</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">## we don't need to supply external objects</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>objects &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">## define the starting and end times of the simulation</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>times &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">start =</span> <span class="fl">1.0</span>, <span class="dt">end =</span> <span class="fl">20.0</span>)</span>
<span id="cb10-12"><a href="#cb10-12"></a></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">## define parameters. This will override any default parameters during this simulation.</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>parameters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="dt">.globals =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">stackName =</span> <span class="st">"landscape"</span>, <span class="dt">burnStats =</span> <span class="st">"nPixelsBurned"</span>),</span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="dt">.progress =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="ot">NA</span>),</span>
<span id="cb10-17"><a href="#cb10-17"></a>  <span class="dt">fireSpreadLcc =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">nFires =</span> 10L, <span class="dt">drought =</span> <span class="dv">1</span>, <span class="dt">its =</span> <span class="fl">1e6</span>,</span>
<span id="cb10-18"><a href="#cb10-18"></a>                    <span class="dt">persistprob =</span> <span class="dv">0</span>, <span class="dt">returnInterval =</span> <span class="dv">1</span>, <span class="dt">startTime =</span> <span class="dv">1</span>,</span>
<span id="cb10-19"><a href="#cb10-19"></a>                    <span class="dt">.plotInitialTime =</span> <span class="ot">NA</span>, <span class="dt">.plotInterval =</span> <span class="dv">10</span>)</span>
<span id="cb10-20"><a href="#cb10-20"></a>)</span>
<span id="cb10-21"><a href="#cb10-21"></a></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">## list parameters</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="kw"><a href="https://rdrr.io/r/utils/ls_str.html">ls.str</a></span>(parameters)</span>
<span id="cb10-24"><a href="#cb10-24"></a></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co">## make simulation object</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>mySim &lt;-<span class="st"> </span><span class="kw">simInit</span>(<span class="dt">times =</span> times, <span class="dt">params =</span> parameters, <span class="dt">modules =</span> modules,</span>
<span id="cb10-27"><a href="#cb10-27"></a>                 <span class="dt">objects =</span> objects, <span class="dt">paths =</span> paths)</span></code></pre></div>
</div>
<div id="simulation-object---simlist" class="section level4">
<h4 class="hasAnchor">
<a href="#simulation-object---simlist" class="anchor"></a>1.3.3 Simulation object - <code>simList</code>
</h4>
<p>The object <code>mySim</code> contains all the necessary information to run the simulation, such as the objects that are shared between modules, and how these are linked between them. It’s called a <code>simList</code>. You can find out more about the <code>simList</code> object <a href="http://spades-workshops.predictiveecology.org/articles/05a-The-simList.html">here</a>.</p>
<p>Let’s have a look at what <code>mySim</code> contains and how modules are connected.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">## list the contents of mySim</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/ls_str.html">ls.str</a></span>(mySim)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw">dev</span>()</span>
<span id="cb11-5"><a href="#cb11-5"></a>mySim<span class="op">$</span>age[] &lt;-<span class="st"> </span>mySim<span class="op">$</span>age[]</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="kw">Plot</span>(mySim<span class="op">$</span>age, <span class="dt">title =</span> <span class="st">"National age map"</span>) <span class="co"># usually faster than plot(mySim$age)</span></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">## plot module connections</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="kw">dev</span>()</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="kw">objectDiagram</span>(mySim)</span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">## see which events are scheduled</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="kw">events</span>(mySim)</span></code></pre></div>
<p>You’ll note that <code>SpaDES</code> has scheduled the initialisation events for each module.</p>
</div>
<div id="running-a-spades-simulation" class="section level4">
<h4 class="hasAnchor">
<a href="#running-a-spades-simulation" class="anchor"></a>1.3.4 Running a <code>SpaDES</code> simulation</h4>
<p>Now that we’ve checked the structure of our simulation model, we can go ahead and run it.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">dev</span>() <span class="co"># to open a new plot device for faster plotting</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">clearPlot</span>()</span>
<span id="cb12-3"><a href="#cb12-3"></a>mySim2 &lt;-<span class="st"> </span><span class="kw">spades</span>(mySim, <span class="dt">debug =</span> <span class="ot">TRUE</span>)   <span class="co"># set debug = TRUE to print simulation steps.</span></span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">## After running the simulation, we can print the event diagram, the completed events and the scheduled events</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="kw">eventDiagram</span>(mySim2)</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="kw">completed</span>(mySim2)</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="kw">events</span>(mySim2)</span></code></pre></div>
<p><img src="images/Day01/LCC2005_plot.png" align="middle" height="400" width="400" margin="0 auto"></p>
</div>
<div id="change-model-parameters-without-restarting" class="section level4">
<h4 class="hasAnchor">
<a href="#change-model-parameters-without-restarting" class="anchor"></a>1.3.5 Change model parameters without restarting</h4>
<p>With <code>SpaDES</code> it is possible to change a simulations’ parameters and then continue running it. This is possible because, even though the simulation stopped at year 20, <code>SpaDES</code> has scheduled the “next” events (see the result of the <code>events</code> call above). Find out more about events and event scheduling <a href="http://spades-workshops.predictiveecology.org/articles/05d-Loops-to-Events.html">here</a>.</p>
<p>What will happen if drought intensity increases and fires become more frequent?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/start.html">end</a></span>(mySim2)    <span class="co">## accesses the last year</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw"><a href="https://rdrr.io/r/stats/start.html">end</a></span>(mySim2) &lt;-<span class="st"> </span><span class="dv">50</span>   <span class="co">## add another 30 years to the end of the simulation. </span></span>
<span id="cb13-3"><a href="#cb13-3"></a>                    <span class="co">## Alternatively use end(mySim2) &lt;- end(mySim2) + 30</span></span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="kw">params</span>(mySim2)<span class="op">$</span>fireSpreadLcc<span class="op">$</span>drought   <span class="co">## accesses the current drought parameter value</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="kw">params</span>(mySim2)<span class="op">$</span>fireSpreadLcc<span class="op">$</span>drought &lt;-<span class="st"> </span><span class="dv">3</span>   <span class="co">## changes it</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="kw">params</span>(mySim2)<span class="op">$</span>fireSpreadLcc<span class="op">$</span>returnInterval  <span class="co">## accesses the current fire return interval value</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="kw">params</span>(mySim2)<span class="op">$</span>fireSpreadLcc<span class="op">$</span>returnInterval &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co">## changes it</span></span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="kw">clearPlot</span>()</span>
<span id="cb13-11"><a href="#cb13-11"></a>mySim3 &lt;-<span class="st"> </span><span class="kw">spades</span>(mySim2, <span class="dt">debug =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="kw"><a href="https://rdrr.io/r/stats/time.html">time</a></span>(mySim2) <span class="co">## "current" time (i.e. the time at which the simulation finished)</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="kw"><a href="https://rdrr.io/r/stats/time.html">time</a></span>(mySim3)</span></code></pre></div>
</div>
<div id="add-a-friends-module" class="section level4">
<h4 class="hasAnchor">
<a href="#add-a-friends-module" class="anchor"></a>1.3.6 Add a friend’s module</h4>
<p>The second part of our question was to investigate how forest fires may affect harvesting. The <code>LCC2005</code> module group does not contain any module that we can use for this, but that’s OK, because we can get modules from other Git repositories.</p>
<p>We will use an <em>extremely</em> simple module that maps areas that are adequate for forest harvesting in function of forest age (a parameter that the user inputs) and the type of forest that can be harvested (here, only coniferous forests). This module, called <code>forestHarvest</code>, will be downloaded from a different repository “CeresBarros/forestHarvest-SpaDESmodule”. Learn more about downloading and sharing modules <a href="http://spades-workshops.predictiveecology.org/articles/03a-Existing-modules.html">here</a>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">downloadModule</span>(<span class="dt">name =</span> <span class="st">"forestHarvest"</span>, <span class="dt">repo =</span> <span class="st">"CeresBarros/forestHarvest-SpaDESmodule"</span>, <span class="dt">path =</span> <span class="kw">getPaths</span>()<span class="op">$</span>modulePath, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">## We've defined the paths earlier </span></span>
<span id="cb14-4"><a href="#cb14-4"></a>paths &lt;-<span class="st"> </span><span class="kw">getPaths</span>()</span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>modules &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"cropReprojectLccAge"</span>, <span class="st">"fireSpreadLcc"</span>, <span class="st">"forestAge"</span>, <span class="st">"forestSuccessionBeacons"</span>, <span class="st">"LccToBeaconsReclassify"</span>, <span class="st">"forestHarvest"</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">## we don't need to suply external objects</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>objects &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</span>
<span id="cb14-10"><a href="#cb14-10"></a></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">## define the starting and end times of the simulation</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>times &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">start =</span> <span class="fl">1.0</span>, <span class="dt">end =</span> <span class="fl">50.0</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">## notice the new parameter list</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>parameters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="dt">.globals =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">stackName =</span> <span class="st">"landscape"</span>, <span class="dt">burnStats =</span> <span class="st">"nPixelsBurned"</span>),</span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="dt">.progress =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="ot">NA</span>),</span>
<span id="cb14-18"><a href="#cb14-18"></a>  <span class="dt">fireSpreadLcc =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">nFires =</span> 10L, <span class="dt">drought =</span> <span class="dv">1</span>, <span class="dt">its =</span> <span class="fl">1e6</span>,</span>
<span id="cb14-19"><a href="#cb14-19"></a>                    <span class="dt">persistprob =</span> <span class="dv">0</span>, <span class="dt">returnInterval =</span> <span class="dv">10</span>, <span class="dt">startTime =</span> <span class="dv">1</span>,</span>
<span id="cb14-20"><a href="#cb14-20"></a>                    <span class="dt">.plotInitialTime =</span> <span class="fl">0.1</span>, <span class="dt">.plotInterval =</span> <span class="dv">10</span>),</span>
<span id="cb14-21"><a href="#cb14-21"></a>  <span class="dt">forestHarvest =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">returnInterval =</span> <span class="dv">5</span>, <span class="dt">harvAge =</span> <span class="dv">50</span>, <span class="dt">startTime =</span> <span class="dv">11</span>, <span class="dt">.plotInterval =</span> <span class="dv">5</span>)</span>
<span id="cb14-22"><a href="#cb14-22"></a>)</span>
<span id="cb14-23"><a href="#cb14-23"></a></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="co">## make simulation object</span></span>
<span id="cb14-25"><a href="#cb14-25"></a>mySim_manag &lt;-<span class="st"> </span><span class="kw">simInit</span>(<span class="dt">times =</span> times, <span class="dt">params =</span> parameters,</span>
<span id="cb14-26"><a href="#cb14-26"></a>                       <span class="dt">modules =</span> modules,</span>
<span id="cb14-27"><a href="#cb14-27"></a>                       <span class="dt">objects =</span> objects, <span class="dt">paths =</span> paths)</span>
<span id="cb14-28"><a href="#cb14-28"></a><span class="kw">dev</span>()</span>
<span id="cb14-29"><a href="#cb14-29"></a><span class="kw">moduleDiagram</span>(mySim_manag)</span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="kw">objectDiagram</span>(mySim_manag)</span>
<span id="cb14-31"><a href="#cb14-31"></a></span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="kw">dev</span>()</span>
<span id="cb14-33"><a href="#cb14-33"></a><span class="kw">clearPlot</span>()</span>
<span id="cb14-34"><a href="#cb14-34"></a>mySim_manag2 &lt;-<span class="st"> </span><span class="kw">spades</span>(mySim_manag, <span class="dt">debug =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="images/Day01/LCC2005harvest_plot.png" align="middle" height="400" width="400" margin="0 auto"></p>
</div>
<div id="choose-to-save-outputs-without-changing-module-code" class="section level4">
<h4 class="hasAnchor">
<a href="#choose-to-save-outputs-without-changing-module-code" class="anchor"></a>1.3.7 Choose to save outputs without changing module code</h4>
<p>It is possible to set <code>SpaDES</code> to save particular objects at a user-defined interval. For this, we need to change the <code>simInit</code> call to include the <code>outputs</code> parameter, where we define the objects to be saved, the saving interval, etc. Check the <code>R</code> help for <code>simInit</code> for more details.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">## Change simInit to include the outputs options</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>mySim_manag &lt;-<span class="st"> </span><span class="kw">simInit</span>(<span class="dt">times =</span> times, <span class="dt">params =</span> parameters,</span>
<span id="cb15-3"><a href="#cb15-3"></a>                       <span class="dt">modules =</span> modules,</span>
<span id="cb15-4"><a href="#cb15-4"></a>                       <span class="dt">objects =</span> objects, <span class="dt">paths =</span> paths,</span>
<span id="cb15-5"><a href="#cb15-5"></a>                       <span class="dt">outputs =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">objectName =</span> <span class="st">"ageMap"</span>, <span class="dt">saveTime =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dt">by =</span> <span class="dv">10</span>)))</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">## Re-run the model</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="kw">dev</span>()</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="kw">clearPlot</span>()</span>
<span id="cb15-9"><a href="#cb15-9"></a>mySim_manag2 &lt;-<span class="st"> </span><span class="kw">spades</span>(mySim_manag, <span class="dt">debug =</span> <span class="ot">TRUE</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">## Print the list of saved outputs</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="kw">outputs</span>(mySim_manag2)</span>
<span id="cb15-13"><a href="#cb15-13"></a></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">## Read the first object (two)</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>ageMap01 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw">outputs</span>(mySim_manag2)<span class="op">$</span>file[<span class="dv">1</span>])</span>
<span id="cb15-16"><a href="#cb15-16"></a></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">## Now you can visualise the saved map in any way you want</span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="kw">dev</span>()</span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="kw">clearPlot</span>()</span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="kw">Plot</span>(ageMap01, <span class="dt">title =</span> <span class="st">"Stand age"</span>)</span>
<span id="cb15-21"><a href="#cb15-21"></a>tble &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(ageMap01[])</span>
<span id="cb15-22"><a href="#cb15-22"></a>frq &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(tble)</span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(frq)[<span class="dv">1</span>] &lt;-<span class="st"> "ageClass"</span></span>
<span id="cb15-24"><a href="#cb15-24"></a>frq <span class="co"># Frequency of age distribution</span></span>
<span id="cb15-25"><a href="#cb15-25"></a></span>
<span id="cb15-26"><a href="#cb15-26"></a>hst &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(ageMap01[])</span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="kw">Plot</span>(hst, <span class="dt">title =</span> <span class="st">"Age distribution"</span>)</span></code></pre></div>
<p>Are there fewer areas that are appropriate for harvesting if fires become larger (i.e. drought is more severe)?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/start.html">end</a></span>(mySim_manag2) &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">params</span>(mySim_manag2)<span class="op">$</span>fireSpreadLcc<span class="op">$</span>drought &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="kw">dev</span>()</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw">clearPlot</span>()</span>
<span id="cb16-5"><a href="#cb16-5"></a>mySim_manag3 &lt;-<span class="st"> </span><span class="kw">spades</span>(mySim_manag2, <span class="dt">debug =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="show-your-spades-model-to-the-world" class="section level3">
<h3 class="hasAnchor">
<a href="#show-your-spades-model-to-the-world" class="anchor"></a>1.4 Show your <code>SpaDES</code> model to the world!</h3>
<p>Soon <code>SpaDES</code> will have another package that will allow building web-apps from <code>simList</code> objects, so that simulation results can be visualised and changed interactively. For now, you can play around with the proof-of-concept <code>shiny</code> app, but also with the real LandWeb project:</p>
<ul>
<li><a href="https://spades.shinyapps.io/ForestChange_ProofOfConcept/" class="uri">https://spades.shinyapps.io/ForestChange_ProofOfConcept/</a></li>
<li><a href="http://landweb.ca/" class="uri">http://landweb.ca/</a></li>
</ul>
</div>
<div id="use-github-com" class="section level3">
<h3 class="hasAnchor">
<a href="#use-github-com" class="anchor"></a>1.5 Use Github.com</h3>
<p>We have shown, in this section, <code>downloadModule</code>. It is good for people who are <em>using</em> modules, but who don’t plan on <em>developing</em> modules. For that, we <strong>should</strong> use version control. All the modules we looked at today can be <em>cloned</em> by going to the web page:</p>
<p><code>https://github.com/PredictiveEcology/SpaDES-modules</code></p>
<p>Also, some of these modules are their own repository, and so you can clone them directly from their own, e.g., <code>LandMine</code>:</p>
<p><code>https://github.com/PredictiveEcology/LandMine</code></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#what-is-spades-and-how-does-it-work">What is <code>SpaDES</code> and how does it work?</a></li>
      <li><a href="#exercises--getting-started-with-spades-in-r">Exercises. Getting started with <code>SpaDES</code> in <code>R</code></a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eliot J B McIntire, Ceres Barros, Tati Micheletti, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
